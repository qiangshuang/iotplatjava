(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b4e7"],{SLZu:function(e,t,o){"use strict";var i=o("ane/");o.n(i).a},"ane/":function(e,t,o){},qnAj:function(e,t,o){"use strict";o.r(t);var i=o("P2sY"),r=o.n(i),a={name:"",mixins:[],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newMapForm:{id:0,region_title:0,title:"",category:0,picurl:"",showhome:"",parent_id:0},mapForm:{},pmst:[{label:0,value:"平面视图"},{label:1,value:"立体视图"}],regionArr:[],showLoading:!1}},mounted:function(){var e=this;this.pObj=r()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.mapForm=r()({},this.newMapForm,this.pObj)):this.mapForm=r()({},this.newMapForm,this.$route.params),this.callSrvAct("/regionlist",{title:"",cp:0,rop:10}).then(function(t){console.log("区域",t),e.regionArr=t.data||[]})},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.mapForm=r()({},this.newMapForm,this.pObj))},regionChange:function(e){console.log(e);for(var t=0;t<this.regionArr.length;t++)this.regionArr[t].title==e&&(this.mapForm.region_id=this.regionArr[t].id,this.mapForm.region_title=this.regionArr[t].title)},submitMapFormImpl:function(e){var t=this,o=void 0,i="";this[e].id>0?(o="/act",!1,i="mapup"):(o="/act",i="mapadd");var a=r()({},this[e]);a._hy=i,this.showLoading=!0,this.apiSrv.callServer(o,a).then(function(e){t.showLoading=!1,t.$router.go(-1)}).catch(function(e){t.showLoading=!1})},handleClick:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.submitMapFormImpl(e)})},handleReset:function(e){this.$refs[e].resetFields()},handleSuccess:function(e,t){console.log("res:",e),this.mapForm.picurl=e.data},genDownUrl:function(e){if(!e||e.length<1)return"";var t=e.split(";");return!t||t.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=map&filename="+t[1]+"&Authorization="+this.apiSrv.token},genUploadUrl:function(e){return this.hysrvport+"/hyupload?btnEncode=headupload&relateType=map&fi=add&Authorization="+this.apiSrv.token},beforeRemove:function(){},close:function(){this.mapForm.picurl="",this.$refs.box.clearFiles()},beforeMapUpload:function(e){var t="image/jpeg"===e.type,o=e.size/1024/1024<20;return t||this.$message.error("上传地图文件只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 20M!"),t&&o}},watch:{paramsObj:function(e){this.pObj.id!=this.paramsObj.id&&(this.pObj=r()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},n=(o("SLZu"),o("KHd+")),l=Object(n.a)(a,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",[o("el-form",{ref:"map",attrs:{model:e.mapForm,"label-position":"left","label-width":"100px"}},[o("el-form-item",{attrs:{label:"选择位置",prop:"region_title",rules:{required:!0,message:"请选择位置",trigger:"blur",min:1}}},[o("el-select",{attrs:{placeholder:"汽机房/配电间"},on:{change:e.regionChange},model:{value:e.mapForm.region_title,callback:function(t){e.$set(e.mapForm,"region_title",t)},expression:"mapForm.region_title"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"名称",prop:"title",rules:{required:!0,message:"请输入名称",trigger:"blur",min:1}}},[o("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.mapForm.title,callback:function(t){e.$set(e.mapForm,"title",t)},expression:"mapForm.title"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"类型",prop:"category",rules:{required:!0,message:"请选择类型",trigger:"blur",min:1}}},[o("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.mapForm.category,callback:function(t){e.$set(e.mapForm,"category",t)},expression:"mapForm.category"}},e._l(e.pmst,function(e){return o("el-option",{key:e.label,attrs:{label:e.value,value:e.label}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"地图文件",prop:"picurl",rules:{required:!0,max:200}}},[o("el-upload",{ref:"box",staticStyle:{width:"178px",height:"178px",border:"1px dashed #d9d9d9","line-height":"178px","text-align":"center",position:"relative"},attrs:{action:e.genUploadUrl(),multiple:!1,"show-file-list":!1,"on-remove":e.beforeRemove,"on-success":e.handleSuccess,limit:1,"before-upload":e.beforeMapUpload}},[e.mapForm.picurl?e._e():o("span",{staticStyle:{"font-size":"24px",color:"#7F7F7F","font-weight":"800"}},[o("i",{staticClass:"el-icon-plus"})]),e._v(" "),e.mapForm.picurl?o("span",{ref:"clos",staticStyle:{position:"absolute",top:"0px",right:"0px"}},[o("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"0px",right:"0px"},on:{click:function(t){return t.stopPropagation(),e.close(t)}}})]):e._e()])],1),e._v(" "),o("el-form-item",{attrs:{label:"是否首页展示",prop:"showhome",rules:{required:!0}}},[o("el-radio-group",{model:{value:e.mapForm.showhome,callback:function(t){e.$set(e.mapForm,"showhome",t)},expression:"mapForm.showhome"}},[o("el-radio",{attrs:{label:"t",title:"是"}}),e._v(" "),o("el-radio",{attrs:{label:"f",title:"否"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"父ID",prop:"parent_id",rules:{required:!0,max:1e11}}},[o("el-input-number",{attrs:{min:-1e10},model:{value:e.mapForm.parent_id,callback:function(t){e.$set(e.mapForm,"parent_id",t)},expression:"mapForm.parent_id"}})],1)],1),e._v(" "),o("div",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{loading:e.showLoading},on:{click:function(t){e.handleClick("mapForm")}}},[o("span",[e._v("保存\n            ")])]),e._v(" "),o("el-button",{staticStyle:{"margin-left":"40px"},on:{click:function(t){e.$router.go(-1)}}},[o("span",[e._v("取消\n            ")])])],1)],1)},[],!1,null,"4af382dd",null);l.options.__file="index.vue";t.default=l.exports}}]);