(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-153e","chunk-17df","chunk-2623"],{"6Fwf":function(t,e,n){"use strict";n.r(e);var o=n("P2sY"),s=n.n(o),i=n("EJiy"),r=n.n(i),a={name:"aiimport",mixins:[n("y2a5").a],components:{},props:{},data:function(){return{importData:[],num:0,success:0,fail:0,repeat:0}},mounted:function(){},methods:{importfxx:function(t){var e=this;e.num=0,e.success=0,e.fail=0,e.repeat=0,console.log(this.$refs.upload.value),this.file=event.currentTarget.files[0],console.log(this.file);var n=this.file,o=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,o,s="";window.console.log(this);var i=new FileReader;i.onload=function(t){window.console.log(t);for(var r=new Uint8Array(i.result),a=r.byteLength,l=0;l<a;l++)s+=String.fromCharCode(r[l]);n=XLSX.read(s,{type:"binary"}),o=XLSX.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),window.console.log(o),console.log("哈哈哈",this.outdata);for(var c=[],p=0;p<o.length;p++)c.push({title:o[p].名称,url:o[p].图标,sensornum:o[p].设备数量});window.console.log(c),e.importData=c,console.log(e.$refs.upload.value),console.log(document.getElementById("upload").value)},i.readAsArrayBuffer(t)},o.readAsBinaryString(n)},fixdata:function(t){for(var e="",n=0,o=10240;n<t.byteLength/o;++n)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(n*o,n*o+o)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(n*o)))},SizeChange:function(){},CurChange:function(){},exportExcel:function(){this.num=0,this.success=0,this.fail=0,this.repeat=0;var t=XLSX.utils.json_to_sheet([{"名称":"","图标":"","设备数量":""}]);console.log(t),this.openDownloadDialog(this.sheet2blob(t),"模板教程.xlsx")},sheet2blob:function(t,e){var n={SheetNames:[e=e||"sheet1"],Sheets:{}};n.Sheets[e]=t;var o=XLSX.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}(o)],{type:"application/octet-stream"})},openDownloadDialog:function(t,e){"object"==(void 0===t?"undefined":r()(t))&&t instanceof Blob&&(t=URL.createObjectURL(t));var n,o=document.createElement("a");o.href=t,o.download=e||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(n)},uploadOk:function(){var t=this;this.num=0,this.success=0,this.fail=0,this.repeat=0,this.num=this.importData.length,console.log("上传数据",this.importData);for(var e=0;e<this.importData.length;e++){var n=s()({},this.importData[e]);console.log("数据",this.importData),n._hy="sensoradd",this.callSrvAct("/act",n).then(function(e){console.log("后台返回",e),"SUCCESS"==e.status?t.success=t.success+1:"FAILED"==e.status&&(t.fail=t.fail+1)})}}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},l=(n("uaYx"),n("KHd+")),c=Object(l.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{direction:"vertical"}},[n("div",[n("div",[n("el-row",{attrs:{autogenchild:!1,childcol:24}},[n("span",[t._v("提示：需保证上传的excel文件为单一文件\n                ")])]),t._v(" "),n("div",{staticStyle:{margin:"10px 0px"}},[n("span",[t._v("请先\n                ")]),t._v(" "),n("el-button",{on:{click:t.exportExcel}},[n("span",[t._v("下载模板和教程\n                    ")])]),t._v(" "),n("span",[t._v("仔细阅读后，按要求填写车辆信息，并上传摄像机信息表格\n                ")])],1),t._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",{staticStyle:{display:"flex",height:"36px","line-height":"35px"}},[n("span",[t._v("上传的文件：\n                    ")]),t._v(" "),n("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"文件路径"}}),t._v(" "),n("el-input",{ref:"upload",attrs:{type:"file",id:"upload"},on:{change:function(e){t.importfxx(this)}}}),t._v(" "),n("el-button",{on:{click:t.uploadOk}},[n("span",[t._v("确认上传\n                        ")])])],1),t._v(" "),n("div",[n("span",[t._v("上传共\n                    ")]),t._v(" "),n("span",[t._v(t._s(t.num)+"\n                    ")]),t._v(" "),n("span",[t._v("条  成功\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"green"}},[t._v(t._s(t.success)+"\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"green"}},[t._v("条\n                    ")]),t._v(" "),n("span",[t._v("失败\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"red"}},[t._v(t._s(t.fail)+"\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"red"}},[t._v("条\n                    ")]),t._v(" "),n("span",[t._v("重复\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.repeat)+"\n                    ")]),t._v(" "),n("span",{staticStyle:{color:"blue"}},[t._v("条\n                    ")])])]),t._v(" "),n("el-table",{attrs:{data:t.importData,"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px","text-align":"center"}}},[n("el-table-column",{attrs:{label:"名称",prop:"title"}}),t._v(" "),n("el-table-column",{attrs:{label:"图标",prop:"url"}}),t._v(" "),n("el-table-column",{attrs:{label:"设备数量",prop:"sensornum"}})],1)],1)])])},[],!1,null,"06c03405",null);c.options.__file="index.vue";e.default=c.exports},"C/qp":function(t,e,n){"use strict";n.r(e);var o=n("P2sY"),s=n.n(o),i={name:"sensortypeedit",mixins:[n("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newSensortypeForm:{id:0,title:"",url:""},sensortypeForm:{}}},mounted:function(){this.pObj=s()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.sensortypeForm=s()({},this.newSensortypeForm,this.pObj)):this.sensortypeForm=s()({},this.newSensortypeForm,this.$route.params)},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.sensortypeForm=s()({},this.newSensortypeForm,this.pObj))},genUploadUrl:function(t){return this.hysrvport+"/hyupload?btnEncode=headupload&relateType=camera&fi=add&Authorization="+this.apiSrv.token},genDownUrl:function(t){if(!t||t.length<1)return"";var e=t.split(";");return!e||e.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=camera&filename="+e[1]+"&Authorization="+this.apiSrv.token},handleAvatarSuccess:function(t,e){this.sensortypeForm.url=t.data},handleClick:function(){console.log("数据",this.sensortypeForm),this.submitOrgForm("sensortypeForm")},submitOrgFormImpl:function(t){var e=this,n=void 0,o=!0,i="";this[t].id>0?(n="/act",o=!1,i="sensorup"):(n="/act",i="sensoradd",this[t].state="关闭");var r=s()({},this[t]);r._hy=i,this.callSrvAct(n,r).then(function(t){e.isInDialog?(console.log("不跳转"),o?t.data&&t.data.inst?(console.log("1111111111"),e.$emit("submitOk",t.data.inst)):t.data&&(console.log("22222222222"),e.$emit("submitOk",t.data||{})):e.$emit("submitOk",r)):(console.log("跳转"),e.$router.go(-1))})},submitOrgForm:function(t){var e=this;this.$refs[t].validate(function(n){if(!n)return!1;e.submitOrgFormImpl(t)})},close:function(){this.sensortypeForm.url="",this.$refs.box.clearFiles()},goClick:function(){this.$emit("submitClose")}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=s()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},r=(n("ycoH"),n("KHd+")),a=Object(r.a)(i,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{direction:"vertical"}},[n("el-form",{ref:"sensortypeForm",attrs:{model:t.sensortypeForm}},[n("el-form-item",{attrs:{label:"传感器名称：",prop:"title",rules:{required:!0,trigger:"input"}}},[n("el-input",{staticStyle:{width:"300px"},model:{value:t.sensortypeForm.title,callback:function(e){t.$set(t.sensortypeForm,"title",e)},expression:"sensortypeForm.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"图标：",prop:"url"}},[n("el-upload",{ref:"box",staticStyle:{border:"1px solid #d9d9d9","border-radius":"6px",cursor:"pointer",position:"relative",overflow:"hidden",width:"100%",height:"178px","line-height":"178px","text-align":"center"},attrs:{action:t.genUploadUrl(),multiple:!1,"on-success":t.handleAvatarSuccess,limit:0,id:"box"}},[t.sensortypeForm.url?n("img",{staticStyle:{"object-fit":"fill"},attrs:{src:t.genDownUrl(t.sensortypeForm.url)}}):n("svg-icon",{staticStyle:{"font-size":"28px",color:"#8c939d"},attrs:{"icon-class":"add"}}),t._v(" "),t.sensortypeForm.url?n("span",{ref:"clos",staticStyle:{position:"absolute",top:"0px",right:"0px"},attrs:{id:"clos"}},[n("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"0px",right:"0px"},on:{click:function(e){return e.stopPropagation(),t.close(e)}}})]):t._e()],1)],1)],1),t._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("el-button",{on:{click:t.handleClick}},[n("span",[t._v("确定\n            ")])]),t._v(" "),n("el-button",{on:{click:t.goClick}},[n("span",[t._v("取消\n            ")])])],1)],1)},[],!1,null,"7f73ee86",null);a.options.__file="index.vue";e.default=a.exports},Cszi:function(t,e,n){},DWyg:function(t,e,n){"use strict";var o=n("nRkd");n.n(o).a},MMyu:function(t,e,n){},"RU/L":function(t,e,n){n("Rqdy");var o=n("WEpk").Object;t.exports=function(t,e,n){return o.defineProperty(t,e,n)}},Rqdy:function(t,e,n){var o=n("Y7ZC");o(o.S+o.F*!n("jmDH"),"Object",{defineProperty:n("2faE").f})},SEkw:function(t,e,n){t.exports={default:n("RU/L"),__esModule:!0}},Y9DM:function(t,e,n){"use strict";n.r(e);var o=n("YEIV"),s=n.n(o),i=n("P2sY"),r=n.n(i),a=n("EJiy"),l=n.n(a),c=n("gDS+"),p=n.n(c),u=n("C/qp"),h=n("6Fwf"),d={name:"sensortype",mixins:[n("y2a5").a],components:{Sensoredit:u.default,Aiimport:h.default},props:{},data:function(){return{sensortypeData:[],sensortypeTotalRec:0,sensortypeTotalPage:0,sensortypeRecOfPage:10,sensortypeCurPage:1,sensortypeCbPage:this.gen_list_cb("sensortype"),sensortypeQueryArr:[{name:"title",val:0,op:"like",tb:"sensortype"}],sensortypeQueryInit:[{name:"title",val:0,op:"like",tb:"sensortype"}],sensortypeMultiSel:[],sensortypeSortParas:[{name:"id",tb:"sensortype",orderV:"desc"}],snesortypeedit:!1,sensortypeInstEdit:null,showimport:!1,importInstEdit:null,tableHeight:window.innerHeight-500}},mounted:function(){this.refreshPage("sensortype","/actq","sensortypelist"),console.log("开始数据",this.sensortypeData)},methods:s()({sensortypeMultiSelChange:function(t){this.sensortypeMultiSel=t},sensortypeQuery:function(){this.refreshPage2("sensortype","/actq",this.remoteRecOfPage,1,"sensortypelist")},sensortypeResetQuery:function(){this.sensortypeQueryArr=JSON.parse(p()(this.sensortypeQueryInit))},sensortypeSizeChange:function(t){this.refreshPage2("sensortype","/actq",t,this.sensortypeCurPage,"sensortypelist")},sensortypeCurChange:function(t){this.refreshPage2("sensortype","/actq",this.sensortypeRecOfPage,t,"sensortypelist")},genDownUrl:function(t){if(!t||t.length<1)return"";var e=t.split(";");return!e||e.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=camera&filename="+e[1]+"&Authorization="+this.apiSrv.token},search:function(){this.refreshPage("sensortype","/actq","sensortypelist")},exportExcel:function(){for(var t=[],e=0;e<this.sensortypeData.length;e++)t.push({"名称":this.sensortypeData[e].title,"图标":this.sensortypeData[e].url,"设备数量":this.sensortypeData[e].sensornum});var n=XLSX.utils.json_to_sheet(t);console.log(n),this.openDownloadDialog(this.sheet2blob(n),"下载1.xlsx")},sheet2blob:function(t,e){var n={SheetNames:[e=e||"sheet1"],Sheets:{}};n.Sheets[e]=t;var o=XLSX.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}(o)],{type:"application/octet-stream"})},openDownloadDialog:function(t,e){"object"==(void 0===t?"undefined":l()(t))&&t instanceof Blob&&(t=URL.createObjectURL(t));var n,o=document.createElement("a");o.href=t,o.download=e||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(n)},editImportSetOK:function(){},showEditImportSet:function(){this.showEditImportSet=!0},importing:function(){this.$router.push({name:"aiimport"})},handlesensortypeDel:function(t,e){var n=this,o=e;console.log("hahaha",e),this.$confirm("此操作将删除该项数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={_hy:"sensortypedel",sensortype:[{name:"id",val:[o.id],op:"in"}]};console.log("upData:",t),n.callSrvAct("/act",t).then(function(t){n.refreshPage("sensortype","/actq","sensortypelist")})}).catch(function(t){n.$message.error(t)})},show3:function(){var t=this;console.log("多选ID",this.sensortypeMultiSel);var e=this;this.$confirm("此操作将删除该项数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n={_hy:"sensortypedel",sensortype:[{name:"id",val:e.sensortypeMultiSel,op:"in"}]};console.log("upData:",n),t.callSrvAct("/act",n).then(function(e){t.refreshPage("sensortype","/actq","sensortypelist")})}).catch(function(e){t.$message.error(e)})},handleChange:function(t){console.log("hahaha",t);for(var e=[],n=0;n<t.length;n++)e.push(t[n].id);this.sensortypeMultiSel=e,this.dataArr=t,console.log("qqq",t)},handlesensortypeEdit:function(t,e){console.log(t,e),this.sensortypeInstEdit=r()({},e),this.snesortypeedit=!0,this.showEditSensortypeSets=!0},add:function(){console.log("dsadas",this.sensortypeInstEdit),this.sensortypeInstEdit={id:0},this.snesortypeedit=!0},editSensortypeSetOK:function(){this.snesortypeedit=!1,this.refreshPage("sensortype","/actq","sensortypelist")},showEditSensortypeSets:function(){this.showEditSensortypeSets=!1}},"showEditSensortypeSets",function(){this.snesortypeedit=!1}),watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},f=(n("DWyg"),n("KHd+")),y=Object(f.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{staticStyle:{height:"100%"},attrs:{direction:"vertical"}},[n("div",{staticStyle:{display:"flex","flex-direction":"row"}},[n("span",{staticStyle:{"margin-top":"6px"}},[t._v("名称\n        ")]),t._v(" "),n("el-input",{staticStyle:{width:"300px","margin-left":"30px"},model:{value:t.sensortypeQueryArr[0].val,callback:function(e){t.$set(t.sensortypeQueryArr[0],"val",e)},expression:"sensortypeQueryArr[0].val"}}),t._v(" "),n("el-button",{staticStyle:{"margin-left":"30px"},on:{click:t.search}},[n("span",[t._v("搜索\n            ")])])],1),t._v(" "),n("div",{staticStyle:{"margin-top":"30px"}},[n("el-button",{on:{click:t.add}},[n("span",[t._v("新增\n            ")])]),t._v(" "),n("el-button",{on:{click:t.show3}},[n("span",[t._v("批量删除\n            ")])]),t._v(" "),n("el-button",{on:{click:t.importing}},[n("span",[t._v("批量导入\n            ")])]),t._v(" "),n("el-button",{on:{click:t.exportExcel}},[n("span",[t._v("批量导出\n            ")])])],1),t._v(" "),n("el-table",{ref:"sensortype",staticStyle:{"margin-top":"10px"},attrs:{border:!0,height:t.tableHeight,"header-cell-style":{background:"#E6F4FF",fontWeight:"500",color:"#0A51C4",borderBottom:"2px solid #4093F7"},data:t.sensortypeData},on:{"selection-change":t.handleChange}},[n("el-table-column",{attrs:{label:"全选",type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{label:"名称",prop:"title",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"图标",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("img",{staticStyle:{width:"100px",height:"30px"},attrs:{src:t.genDownUrl(e.row.url)}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"设备数量",prop:"sensornum",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticStyle:{"margin-top":"10px"}},[n("el-button",{on:{click:function(n){t.handlesensortypeEdit(e.$index,e.row)}}},[n("span",[t._v("编辑\n                        ")])]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(n){t.handlesensortypeDel(e.$index,e.row)}}},[n("span",[t._v("删除\n                        ")])])],1)]}}])})],1),t._v(" "),n("el-pagination",{ref:"sensortype",staticStyle:{"text-align":"center"},attrs:{total:t.sensortypeTotalRec,"page-count":t.sensortypeTotalPage,layout:"total, sizes, prev, pager, next"},on:{"size-change":t.sensortypeSizeChange,"current-change":t.sensortypeCurChange}}),t._v(" "),t.snesortypeedit?n("el-dialog",{attrs:{visible:t.snesortypeedit,title:"新增传感器类型"},on:{"update:visible":function(e){t.snesortypeedit=e}}},[n("sensoredit",{attrs:{paramsObj:t.sensortypeInstEdit},on:{submitOk:t.editSensortypeSetOK,submitClose:t.showEditSensortypeSets}})],1):t._e(),t._v(" "),n("el-dialog",{attrs:{visible:t.showimport,title:"导入"},on:{"update:visible":function(e){t.showimport=e}}},[n("aiimport",{attrs:{paramsObj:t.importInstEdit},on:{submitOk:t.editImportSetOK,submitClose:t.showEditImportSet}})],1)],1)},[],!1,null,"2cae677d",null);y.options.__file="index.vue";e.default=y.exports},YEIV:function(t,e,n){"use strict";e.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(n("SEkw"));e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},nRkd:function(t,e,n){},uaYx:function(t,e,n){"use strict";var o=n("MMyu");n.n(o).a},ycoH:function(t,e,n){"use strict";var o=n("Cszi");n.n(o).a}}]);