(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0ebe"],{"/KZd":function(t,e,a){},LtD9:function(t,e,a){"use strict";a.r(e);var i={name:"visitrecord",mixins:[a("y2a5").a],components:{},props:{},data:function(){return{accesslogData:[],accesslogTotalRec:0,accesslogTotalPage:0,accesslogRecOfPage:10,accesslogCurPage:1,accesslogCbPage:this.gen_list_cb("accesslog"),accesslogQueryArr:[],accesslogQueryInit:[],tableHeight:window.innerHeight-500,stateArr:[{value:"",label:"全部"},{value:"允许通过",label:"允许通过"},{value:"禁止通过",label:"禁止通过"}],defaultSort:"ascending",parent_title:"",state:"",visit_title:"",gateway_titlee:"",idnumber:"",mobile:"",starttime:"",endtime:"",org_id:"",userpic:"",vistpic:"",tsSelLabel:"",deptShowVal:"",tsData:[],deptProps:{label:"title",isLeaf:"isLeaf",children:"children"}}},mounted:function(){var t=this;this.callSrvAct("/visithistorylist",{parent_title:"",cp:this.accesslogCurPage,rop:this.accesslogRecOfPage}).then(function(e){t.accesslogData=e.data.pageData||[],t.accesslogTotalRec=e.data.totalRec,t.accesslogRecOfPage=e.data.rop,t.accesslogCurPage=e.data.cp});this.callSrvAct("/actq",{_hy:"departlist",qps:[{name:"type",val:"部门",tb:"org"}],sps:[{name:"title",tb:"org",orderV:"asc"}]}).then(function(e){for(var a=e.data||[],i=0;i<a.length;i++)t.fillDepatData(t.tsData,a[i])})},methods:{filterDepart:function(t){t!=this.tsSelLabel&&this.$refs.depttreein.filter(t)},testScrollHeight:function(){this.$nextTick(function(){var t=document.querySelectorAll(".el-scrollbar .el-select-dropdown__wrap")[0],e=document.querySelectorAll(".el-scrollbar .el-scrollbar__bar");t.style.cssText="margin:0px;max-height:500px;overflow:auto;",e.forEach(function(t){return t.style.width=0})})},fillDepatData:function(t,e){if(!e)return!0;if(e.parent_id<1)return e.children=[],e.isLeaf=!0,t.push(e),!0;for(var a=0;a<t.length;a++)if(t[a].id==e.parent_id)return e.children=[],e.isLeaf=!0,t[a].children.push(e),t[a].isLeaf=!1,!0;for(var i=0;i<t.length;i++){if(t[i].children.length>0)if(this.fillDepatData(t[i].children,e))return!0}return!1},handleDeptNodeClick:function(t,e,a){this.tsSelLabel=t.title,this.deptShowVal=t.title,this.org_id=t.id||0,this.$refs.depttree.blur()},filterDeptNode:function(t,e){return!t||-1!==e.title.indexOf(t)},search:function(){var t=this;this.callSrvAct("/visithistorylist",{org_id:this.org_id,state:this.state,visit_title:this.visit_title,gateway_titlee:this.gateway_titlee,idnumber:this.idnumber,mobile:this.mobile,starttime:this.starttime,endtime:this.endtime,cp:1,rop:this.accesslogRecOfPage}).then(function(e){t.accesslogData=e.data.pageData||[],t.accesslogTotalRec=e.data.totalRec,t.accesslogRecOfPage=e.data.rop,t.accesslogCurPage=e.data.cp})},genDownUrl:function(t){if(!t||t.length<1)return"";var e=t.split(";");return!e||e.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=camera&filename="+e[1]+"&Authorization="+this.apiSrv.token},time:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"  "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},accesslogSizeChange:function(t){var e=this;this.callSrvAct("/visithistorylist",{org_id:this.org_id,state:this.state,visit_title:this.visit_title,gateway_titlee:this.gateway_titlee,idnumber:this.idnumber,mobile:this.mobile,visittime:this.starttime,cardnumber:this.cardnumber,vistpic:this.vistpic,userpic:this.userpic,cp:this.accesslogCurPage,rop:t}).then(function(t){e.accesslogData=t.data.pageData||[],e.accesslogTotalRec=t.data.totalRec,e.accesslogRecOfPage=t.data.rop,e.accesslogCurPage=t.data.cp})},accesslogCurChange:function(t){var e=this;this.callSrvAct("/visithistorylist",{org_id:this.org_id,state:this.state,visit_title:this.visit_title,gateway_titlee:this.gateway_titlee,idnumber:this.idnumber,mobile:this.mobile,visittime:this.starttime,cardnumber:this.cardnumber,vistpic:this.vistpic,userpic:this.userpic,cp:t,rop:this.accesslogRecOfPage}).then(function(t){e.accesslogData=t.data.pageData||[],e.accesslogTotalRec=t.data.totalRec,e.accesslogRecOfPage=t.data.rop,e.accesslogCurPage=t.data.cp})}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},l=(a("hQyj"),a("KHd+")),s=Object(l.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"100%"},attrs:{direction:"vertical"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{width:"70px","margin-right":"6px"}},[t._v("人员部门\n                ")]),t._v(" "),a("el-select",{ref:"depttree",staticStyle:{width:"calc(100% - 76px)"},attrs:{filterable:!0,"filter-method":t.filterDepart,id:"depttree"},model:{value:t.deptShowVal,callback:function(e){t.deptShowVal=e},expression:"deptShowVal"}},[a("el-option",{staticStyle:{"min-height":"30px",background:"#fff"},attrs:{value:t.org_id,label:t.tsSelLabel}},[a("el-tree",{ref:"depttreein",attrs:{accordion:!1,"node-key":"id",data:t.tsData,props:t.deptProps,"filter-node-method":t.filterDeptNode},on:{"node-click":t.handleDeptNodeClick}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{"margin-left":"33px",width:"70px","margin-right":"6px"}},[t._v("状态\n                ")]),t._v(" "),a("el-select",{staticStyle:{width:"calc(100% - 76px)"},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.stateArr,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{width:"70px","margin-right":"6px"}},[t._v("通行时间\n                ")]),t._v(" "),a("el-date-picker",{attrs:{placeholder:"开始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"timestamp",type:"datetime"},model:{value:t.starttime,callback:function(e){t.starttime=e},expression:"starttime"}}),t._v(" "),a("span",[t._v("-\n                ")]),t._v(" "),a("el-date-picker",{attrs:{placeholder:"结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"timestamp",type:"datetime"},model:{value:t.endtime,callback:function(e){t.endtime=e},expression:"endtime"}})],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","margin-top":"20px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{"margin-left":"33px",width:"70px","margin-right":"6px"}},[t._v("姓名\n                ")]),t._v(" "),a("el-input",{staticStyle:{width:"calc(100% - 76px)"},model:{value:t.visit_title,callback:function(e){t.visit_title=e},expression:"visit_title"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{width:"70px","margin-right":"6px"}},[t._v("设备名称\n                ")]),t._v(" "),a("el-input",{staticStyle:{width:"calc(100% - 76px)"},model:{value:t.gateway_titlee,callback:function(e){t.gateway_titlee=e},expression:"gateway_titlee"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{width:"70px","margin-right":"6px"}},[t._v("身份证号\n                ")]),t._v(" "),a("el-input",{staticStyle:{width:"calc(100% - 76px)"},model:{value:t.idnumber,callback:function(e){t.idnumber=e},expression:"idnumber"}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{"margin-left":"16px",width:"70px","margin-right":"6px"}},[t._v("手机号\n                ")]),t._v(" "),a("el-input",{staticStyle:{width:"calc(100% - 76px)"},model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}})],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary"},on:{click:t.search}},[a("span",[t._v("搜索\n            ")])])],1),t._v(" "),a("el-table",{ref:"accesslog",staticStyle:{margin:"10px 0px"},attrs:{stripe:!0,border:!0,height:t.tableHeight,"header-cell-style":{background:"#E6F4FF",fontWeight:"500",color:"#0A51C4",borderBottom:"2px solid #4093F7"},"default-sort":{},data:t.accesslogData}},[a("el-table-column",{attrs:{label:"访问时间",prop:"visittime",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.time(e.row.visittime))+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"设备名称",prop:"gateway_titlee",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"visit_title",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"性别",prop:"gender",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"部门",prop:"parent_title",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"工号",prop:"cardnumber",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"身份证号",prop:"idnumber",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"手机号",prop:"mobile",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"state",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"抓拍图片",prop:"vistpic",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:t.genDownUrl(e.row.vistpic)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"底库照片",prop:"userpic",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:t.genDownUrl(e.row.userpic)}})]}}])})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{"page-size":t.accesslogRecOfPage,total:t.accesslogTotalRec,"page-count":t.accesslogTotalPage,"current-page":t.accesslogCurPage,layout:"total, sizes, prev, pager, next"},on:{"size-change":t.accesslogSizeChange,"current-change":t.accesslogCurChange}})],1)],1)},[],!1,null,"dbdabca0",null);s.options.__file="index.vue";e.default=s.exports},hQyj:function(t,e,a){"use strict";var i=a("/KZd");a.n(i).a}}]);