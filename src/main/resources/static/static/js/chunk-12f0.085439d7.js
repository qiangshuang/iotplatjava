(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-12f0"],{"0N4M":function(t,e,n){"use strict";var o=n("FN00");n.n(o).a},FN00:function(t,e,n){},"RU/L":function(t,e,n){n("Rqdy");var o=n("WEpk").Object;t.exports=function(t,e,n){return o.defineProperty(t,e,n)}},Rqdy:function(t,e,n){var o=n("Y7ZC");o(o.S+o.F*!n("jmDH"),"Object",{defineProperty:n("2faE").f})},SEkw:function(t,e,n){t.exports={default:n("RU/L"),__esModule:!0}},YEIV:function(t,e,n){"use strict";e.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(n("SEkw"));e.default=function(t,e,n){return e in t?(0,o.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},ntYl:function(t,e,n){"use strict";n.r(e);var o=n("P2sY"),r=n.n(o),i=n("YEIV"),a=n.n(i),s=n("y2a5"),u=n("fZJM"),l=n.n(u),d={name:"login",mixins:[s.a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){var t;return t={newLoginForm:{id:0,userName:"",pwd:""},loginForm:{}},a()(t,"newLoginForm",{id:0,userName:"",pwd:"",salt:""}),a()(t,"passwordType","password"),a()(t,"randomImgSrc",this.hysrvport+"/captcha"),a()(t,"loading",!1),a()(t,"rnumber",""),t},mounted:function(){console.log(" -----1 "),this.pObj=r()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.loginForm=r()({},this.newLoginForm,this.pObj)):this.loginForm=r()({},this.newLoginForm,this.$route.params),console.log(" ----- ")},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.loginForm=r()({},this.newLoginForm,this.pObj))},showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},handleLogin:function(){var t=this;this.$refs.loginForm.validate(function(e){if(!e)return!1;var n=l.a.sha1().update(t.loginForm.pwd).digest("hex"),o=new JSEncrypt;o.setPublicKey(t.apiSrv.getPubkey()),t.loginForm.salt=t.randomString(4),t.rnumber=t.randomString(4),console.log(t.loginForm.salt,t.rnumber);var i=t.loginForm.salt+","+t.rnumber+","+t.loginForm.userName+","+n,a=o.encrypt(i);t.callSrvAct("/login",a).then(function(e){if(e.status&&"SUCCESS"==e.status){e.Authorization&&e.Authorization.length>0&&t.apiSrv.setToken(e.Authorization),e.data.menuList&&e.data.menuList.length>0&&t.$router.addRoutes(t.$router.options.generateRoutes(e.data.menuList)),e.data.userInfo.user_name=t.loginForm.userName;var n=r()({},t.loginForm,e.data.userInfo),o=r()({},{userDetail:n},{org:e.data.org},{menuList:e.data.menuList});console.log("res xxx 4:",e.data.menuList),t.$store.dispatch("setUserInfo",o).then(function(){t.$router.push("/")})}})})},randomString:function(t){t=t||32;var e="1234567890".length,n="",o=0;for(o=0;o<t;o++)n+="1234567890".charAt(Math.floor(Math.random()*e));return n}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=r()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},p=(n("0N4M"),n("KHd+")),c=Object(p.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{staticStyle:{"background-image":"url(/static/image/index.png)",width:"100%",height:"100%","background-size":"100% 100%"},attrs:{direction:"vertical"}},[n("div",{staticStyle:{width:"100%","margin-top":"170px"}},[n("div",{staticStyle:{width:"450px",margin:"0 auto","background-color":"#fff",padding:"20px","border-radius":"15px"}},[n("div",{staticStyle:{width:"100%","text-align":"center","padding-bottom":"10px","margin-bottom":"20px"}},[n("span",{staticStyle:{color:"#666666","font-weight":"bold","font-size":"24px"}},[t._v("工业物联网大数据平台\n                ")])]),t._v(" "),n("el-form",{ref:"loginForm",staticStyle:{"text-align":"center",width:"280px",margin:"0 auto"},attrs:{model:t.loginForm,"label-width":"70px"}},[n("el-form-item",{attrs:{label:"账号：",prop:"userName",rules:{required:!0,message:"账号必填",trigger:"input"}}},[n("el-input",{attrs:{placeholder:"请输入账号"},model:{value:t.loginForm.userName,callback:function(e){t.$set(t.loginForm,"userName",e)},expression:"loginForm.userName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"密码：",prop:"pwd",rules:{required:!0,message:"密码必填",trigger:"input"}}},[n("el-input",{attrs:{placeholder:"请输入密码",type:t.passwordType},model:{value:t.loginForm.pwd,callback:function(e){t.$set(t.loginForm,"pwd",e)},expression:"loginForm.pwd"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:""}},[n("el-button",{staticStyle:{"background-color":"#169BD5",width:"100%"},attrs:{size:"medium"},on:{click:t.handleLogin}},[n("span",{staticStyle:{color:"#fff"}},[t._v("登录\n                            ")])])],1)],1)],1)])])},[],!1,null,"d7923fbe",null);c.options.__file="index.vue";e.default=c.exports}}]);