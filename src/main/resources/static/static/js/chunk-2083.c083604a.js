(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2083"],{ANAT:function(t,e,i){"use strict";var a=i("KRIh");i.n(a).a},KRIh:function(t,e,i){},"SI/S":function(t,e,i){"use strict";i.r(e);var a=i("P2sY"),o=i.n(a),r={name:"approval",mixins:[i("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newApprovalForm:{id:0,user_title:"",idnumber:"",gender:"",mobile:"",interview_titles:"",gateway_title:""},approvalForm:{},dialogTableVisible:!1,visitHistoryData:[],visitHistoryTotalRec:0,visitHistoryTotalPage:0,visitHistoryRecOfPage:10,visitHistoryCurPage:1,visitHistoryCbPage:this.gen_list_cb("visitHistory"),visitHistoryQueryArr:[],visitHistoryQueryInit:[],agreeLoading:!1}},mounted:function(){var t=this;this.pObj=o()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.approvalForm=o()({},this.newApprovalForm,this.pObj)):this.approvalForm=o()({},this.newApprovalForm,this.$route.params);var e=this.$route.params.id;this.callSrvAct("/visitresult",{id:e}).then(function(e){console.log("数据",e),t.approvalForm=e.data,t.visitHistoryData=e.data.visitHistory})},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.approvalForm=o()({},this.newApprovalForm,this.pObj))},charsIntercept:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return e.substring(i+1,e.length)},closingevent:function(){this.dialogTableVisible=!1},showDialog:function(){this.dialogTableVisible=!0},agree:function(){var t=this;this.agreeLoading=!0,this.apiSrv.callServer("/visitallow",{id:this.approvalForm.id}).then(function(e){t.agreeLoading=!1,"SUCCESS"==e.status&&t.$confirm("已同意","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(t){})}).catch(function(e){t.agreeLoading=!1})},refuse:function(){var t=this;this.callSrvAct("/visitprohibit",{id:this.approvalForm.id}).then(function(e){console.log("拒绝",e),"SUCCESS"==e.status&&t.$confirm("已拒绝","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(t){})})},timess:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"  "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},genDownUrl:function(t){if(!t||t.length<1)return"";var e=t.split(";");return!e||e.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=headimage&filename="+e[1]+"&Authorization="+this.apiSrv.token}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=o()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},n=(i("ANAT"),i("KHd+")),l=Object(n.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",{attrs:{direction:"vertical"}},[i("el-form",{attrs:{model:t.approvalForm,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"姓名：",prop:"user_title"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.user_title,callback:function(e){t.$set(t.approvalForm,"user_title",e)},expression:"approvalForm.user_title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"人脸照片：",prop:""}},[i("img",{staticStyle:{width:"178px",height:"178px"},attrs:{src:t.genDownUrl(t.approvalForm.photo)}})]),t._v(" "),i("el-form-item",{attrs:{label:"身份证号：",prop:"idnumber"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.idnumber,callback:function(e){t.$set(t.approvalForm,"idnumber",e)},expression:"approvalForm.idnumber"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"性别：",prop:"gender"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.gender,callback:function(e){t.$set(t.approvalForm,"gender",e)},expression:"approvalForm.gender"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号：",prop:"mobile"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.mobile,callback:function(e){t.$set(t.approvalForm,"mobile",e)},expression:"approvalForm.mobile"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"被访人员：",prop:"interview_titles"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.interview_titles,callback:function(e){t.$set(t.approvalForm,"interview_titles",e)},expression:"approvalForm.interview_titles"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"通行门禁：",prop:"gateway_title"}},[i("el-input",{staticStyle:{width:"220px"},model:{value:t.approvalForm.gateway_title,callback:function(e){t.$set(t.approvalForm,"gateway_title",e)},expression:"approvalForm.gateway_title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"通行时间：",prop:""}},[i("div",[i("span",[t._v(t._s(t.timess(t.approvalForm.starttime)+" 至 "+t.timess(t.approvalForm.endtime))+"\n                ")])])])],1),t._v(" "),i("div",{staticStyle:{"padding-left":"38px"}},[i("span",[t._v("历史访问记录\n        ")]),t._v(" "),i("span",{staticStyle:{"margin-left":"20px",color:"#02A7F0"},on:{click:t.showDialog}},[t._v("查看\n        ")])]),t._v(" "),t.dialogTableVisible?i("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"历史记录",modal:!1},on:{"update:visible":function(e){t.dialogTableVisible=e},close:t.closingevent}},[i("el-table",{ref:"visitHistory",staticStyle:{margin:"10px 0px"},attrs:{border:!0,"header-cell-style":{background:"#E6F4FF",fontWeight:"500",color:"#0A51C4",borderBottom:"2px solid #4093F7"},data:t.visitHistoryData}},[i("el-table-column",{attrs:{label:"被访问人",prop:"interview_titles"}}),t._v(" "),i("el-table-column",{attrs:{label:"门禁",prop:"gateway_title"}}),t._v(" "),i("el-table-column",{attrs:{label:"允许通行时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.timess(e.row.starttime))+"\n                    ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"允许通行结束时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.timess(e.row.endtime))+"\n                    ")])]}}])})],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.closingevent}},[i("span",[t._v("关闭\n                ")])])],1)],1):t._e(),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{on:{click:t.refuse}},[i("span",[t._v("拒绝\n            ")])]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.agreeLoading},on:{click:t.agree}},[i("span",[t._v("同意\n            ")])])],1)],1)},[],!1,null,"544359b3",null);l.options.__file="index.vue";e.default=l.exports}}]);