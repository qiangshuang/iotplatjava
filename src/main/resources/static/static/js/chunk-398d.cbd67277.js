(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-398d"],{JIrF:function(e,t,r){},"RU/L":function(e,t,r){r("Rqdy");var i=r("WEpk").Object;e.exports=function(e,t,r){return i.defineProperty(e,t,r)}},Rqdy:function(e,t,r){var i=r("Y7ZC");i(i.S+i.F*!r("jmDH"),"Object",{defineProperty:r("2faE").f})},SEkw:function(e,t,r){e.exports={default:r("RU/L"),__esModule:!0}},YEIV:function(e,t,r){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(r("SEkw"));t.default=function(e,t,r){return t in e?(0,i.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},bHE8:function(e,t,r){"use strict";r.r(t);var i=r("P2sY"),o=r.n(i),s=r("YEIV"),n=r.n(s),a={name:"personedit",mixins:[r("y2a5").a],inject:["routerRefresh"],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){var e;return e={newUserForm:{id:0,title:"",job_title:"",idnumber:"",user_name:"",mobile:"",gender:"",cardnumber:0,updated:(new Date).getTime(),image:""},userForm:{}},n()(e,"newUserForm",{id:0,parent_id:0,parent_title:"",title:"",job_title:"",idnumber:"",user_name:"",mobile:"",gender:"",cardnumber:0,updated:(new Date).getTime(),photo:""}),n()(e,"userForm",{}),n()(e,"orgDatas",[]),n()(e,"org_title",""),n()(e,"rules",{idnumber:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{pattern:/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}$)/,message:"证件号码格式有误！",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^((13[0-9])|(17[0-1,6-8])|(15[^4,\\D])|(18[0-9]))\d{8}$/,message:"手机号码格式有误！",trigger:"blur"}],parent_id:[{required:!0,message:"请选择用户所属部门",trigger:"blur"}]}),n()(e,"tsSelLabel",""),n()(e,"deptShowVal",""),n()(e,"tsData",[]),n()(e,"deptProps",{label:"title",isLeaf:"isLeaf",children:"children"}),e},mounted:function(){var e=this;this.pObj=o()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.userForm=o()({},this.newUserForm,this.pObj)):this.userForm=o()({},this.newUserForm,this.$route.params),this.tsSelLabel=this.userForm.parent_title,this.deptShowVal=this.userForm.parent_title;this.callSrvAct("/actq",{_hy:"departlist",qps:[{name:"type",val:"部门",tb:"org"}],sps:[{name:"title",tb:"org",orderV:"asc"}]}).then(function(t){for(var r=t.data||[],i=0;i<r.length;i++)e.fillDepatData(e.tsData,r[i])})},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.userForm=o()({},this.newUserForm,this.pObj)):this.userForm=o()({},this.newUserForm,this.$route.params)},filterDepart:function(e){e!=this.tsSelLabel&&this.$refs.depttreein.filter(e)},testScrollHeight:function(){this.$nextTick(function(){var e=document.querySelectorAll(".el-scrollbar .el-select-dropdown__wrap")[0],t=document.querySelectorAll(".el-scrollbar .el-scrollbar__bar");e.style.cssText="margin:0px;max-height:500px;overflow:auto;",t.forEach(function(e){return e.style.width=0})})},fillDepatData:function(e,t){if(!t)return!0;if(t.parent_id<1)return t.children=[],t.isLeaf=!0,e.push(t),!0;for(var r=0;r<e.length;r++)if(e[r].id==t.parent_id)return t.children=[],t.isLeaf=!0,e[r].children.push(t),e[r].isLeaf=!1,!0;for(var i=0;i<e.length;i++){if(e[i].children.length>0)if(this.fillDepatData(e[i].children,t))return!0}return!1},handleDeptNodeClick:function(e,t,r){this.tsSelLabel=e.title,this.deptShowVal=e.title,this.userForm.parent_id=e.id||0,this.userForm.parent_title=e.title||"",this.$refs.depttree.blur()},filterDeptNode:function(e,t){return!e||-1!==t.title.indexOf(e)},submitPersonFormImpl:function(e){var t=this,r=void 0,i="";this[e].id>0?(r="/act",!1,i="userup"):(r="/act",i="useradd");var s=o()({},this[e]);s._hy=i,this.callSrvAct(r,s).then(function(e){t.$router.go(-1)})},handleClick:function(e){var t=this;this[e].parent_id<1?this.$message.info("请选择用户所属部门"):(this.$refs[e].validate(function(r){if(!r)return!1;t.submitPersonFormImpl(e)}),console.log("结果",this.userForm))},handleReset:function(e){this.$refs[e].resetFields()},handleSuccess:function(e,t){console.log("res:",e),this.userForm.photo=e.data},genDownUrl:function(e){if(!e||e.length<1)return"";var t=e.split(";");return!t||t.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=headimage&filename="+t[1]+"&Authorization="+this.apiSrv.token},genUploadUrl:function(e){return this.hysrvport+"/hyupload?btnEncode=headupload&relateType=headimage&fi=add&Authorization="+this.apiSrv.token},beforeRemove:function(){},close:function(){this.userForm.photo="",this.$refs.box.clearFiles()},orgChange:function(e){console.log(e)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r=e.size/1024<200;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 200kb!"),t&&r}},watch:{paramsObj:function(e){this.pObj.id!=this.paramsObj.id&&(this.pObj=o()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},l=(r("sBze"),r("KHd+")),u=Object(l.a)(a,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{attrs:{direction:"vertical"}},[r("el-form",{ref:"userForm",staticStyle:{"margin-top":"20px"},attrs:{model:e.userForm,"label-width":"120px",rules:e.rules}},[r("el-form-item",{attrs:{label:"部门：",prop:"",rules:{required:!0,message:"请选择用户所属部门",trigger:"blur"}}},[r("el-select",{ref:"depttree",staticStyle:{width:"300px"},attrs:{filterable:!0,"filter-method":e.filterDepart,id:"depttree"},model:{value:e.deptShowVal,callback:function(t){e.deptShowVal=t},expression:"deptShowVal"}},[r("el-option",{staticStyle:{"min-height":"30px",background:"#fff"},attrs:{value:e.userForm.parent_id,label:e.tsSelLabel}},[r("el-tree",{ref:"depttreein",attrs:{accordion:!1,"node-key":"id",data:e.tsData,props:e.deptProps,"filter-node-method":e.filterDeptNode},on:{"node-click":e.handleDeptNodeClick}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名：",prop:"title",rules:{required:!0,message:"请输入姓名",trigger:"blue"}}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入姓名"},model:{value:e.userForm.title,callback:function(t){e.$set(e.userForm,"title",t)},expression:"userForm.title"}})],1),e._v(" "),e._e(),e._v(" "),r("el-form-item",{attrs:{label:"身份证号：",prop:"idnumber"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入身份证号"},model:{value:e.userForm.idnumber,callback:function(t){e.$set(e.userForm,"idnumber",t)},expression:"userForm.idnumber"}})],1),e._v(" "),e._e(),e._v(" "),r("el-form-item",{attrs:{label:"手机号：",prop:"mobile"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入手机号"},model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别：",prop:"gender",rules:{required:!0,message:"请选择性别",trigger:"blur",max:12}}},[r("el-radio-group",{model:{value:e.userForm.gender,callback:function(t){e.$set(e.userForm,"gender",t)},expression:"userForm.gender"}},[r("el-radio",{attrs:{label:"男"}},[r("span",[e._v("男\n                    ")])]),e._v(" "),r("el-radio",{attrs:{label:"女"}},[r("span",[e._v("女\n                    ")])])],1)],1),e._v(" "),e._e(),e._v(" "),e._e(),e._v(" "),r("el-form-item",{attrs:{label:"上传照片：",prop:"image"}},[r("el-upload",{ref:"box",staticStyle:{width:"178px",height:"178px",border:"1px dashed #d9d9d9","line-height":"178px","text-align":"center",position:"relative"},attrs:{action:e.genUploadUrl(),multiple:!1,"show-file-list":!1,"on-remove":e.beforeRemove,"on-success":e.handleSuccess,limit:1,id:"box","before-upload":e.beforeAvatarUpload}},[e.userForm.photo?r("img",{staticStyle:{width:"178px",height:"178px",display:"block"},attrs:{src:e.genDownUrl(e.userForm.photo)}}):e._e(),e._v(" "),e.userForm.photo?e._e():r("span",{staticStyle:{"font-size":"24px",color:"#7F7F7F","font-weight":"800"}},[r("i",{staticClass:"el-icon-plus"})]),e._v(" "),e.userForm.photo?r("span",{ref:"clos",staticStyle:{position:"absolute",top:"0px",right:"0px"},attrs:{id:"clos"}},[r("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"0px",right:"0px"},on:{click:function(t){return t.stopPropagation(),e.close(t)}}})]):e._e()])],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{on:{click:function(t){e.handleClick("userForm")}}},[r("span",[e._v("提交\n            ")])]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"40px"},on:{click:function(t){e.handleReset("userForm")}}},[r("span",[e._v("重置\n            ")])])],1)],1)},[],!1,null,"c9a885b4",null);u.options.__file="index.vue";t.default=u.exports},sBze:function(e,t,r){"use strict";var i=r("JIrF");r.n(i).a}}]);