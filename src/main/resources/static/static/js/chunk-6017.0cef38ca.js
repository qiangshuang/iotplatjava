(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6017"],{"+Ppq":function(t,e,n){"use strict";var o=n("rI3T");n.n(o).a},"pqQ+":function(t,e,n){"use strict";n.r(e);var o=n("P2sY"),a=n.n(o),l=n("EJiy"),i=n.n(l),r={name:"bulkimport",mixins:[n("y2a5").a],components:{},props:{},data:function(){return{importData:[],num:0,success:0,fail:0,repeat:0}},mounted:function(){},methods:{importfxx:function(t){var e=this;e.num=0,e.success=0,e.fail=0,e.repeat=0,console.log(this.$refs.upload.value),this.file=event.currentTarget.files[0],console.log(this.file);var n=this.file,o=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,o,a="";window.console.log(this);var l=new FileReader;l.onload=function(t){window.console.log(t);for(var i=new Uint8Array(l.result),r=i.byteLength,s=0;s<r;s++)a+=String.fromCharCode(i[s]);n=XLSX.read(a,{type:"binary"}),o=XLSX.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),window.console.log("哈哈哈",o);for(var c=[],p=0;p<o.length;p++)c.push({title:o[p].摄像机名称,region_title:o[p].摄像机位置,videoa:o[p].视频地址,state:o[p].状态,algorithms:o[p].算法,resolution:o[p].分辨率,framerate:o[p].帧率,corp:o[p].厂商});window.console.log(c),e.importData=c,console.log(e.$refs.upload.value),console.log(document.getElementById("upload").value)},l.readAsArrayBuffer(t)},o.readAsBinaryString(n)},fixdata:function(t){for(var e="",n=0,o=10240;n<t.byteLength/o;++n)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(n*o,n*o+o)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(n*o)))},SizeChange:function(){},CurChange:function(){},exportExcel:function(){this.num=0,this.success=0,this.fail=0,this.repeat=0;var t=XLSX.utils.json_to_sheet([{"摄像机名称":"","摄像机位置":"","视频地址":"","状态":"","算法":"","分辨率":"","帧率":"","厂商":""}]);console.log(t),this.openDownloadDialog(this.sheet2blob(t),"模板教程.xlsx")},sheet2blob:function(t,e){var n={SheetNames:[e=e||"sheet1"],Sheets:{}};n.Sheets[e]=t;var o=XLSX.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}(o)],{type:"application/octet-stream"})},openDownloadDialog:function(t,e){"object"==(void 0===t?"undefined":i()(t))&&t instanceof Blob&&(t=URL.createObjectURL(t));var n,o=document.createElement("a");o.href=t,o.download=e||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(n)},uploadOk:function(){var t=this;this.num=0,this.success=0,this.fail=0,this.repeat=0,this.num=this.importData.length,console.log("上传数据",this.importData);for(var e=0;e<this.importData.length;e++){this.importData[e].pos="",this.importData[e].url="",this.importData[e].scene="",this.importData[e].algorithms="",this.importData[e].codec="";var n=a()({},this.importData[e]);n._hy="cameraadd",this.callSrvAct("/act",n).then(function(e){console.log("后台返回",e),"SUCCESS"==e.status?t.success=t.success+1:"FAILED"==e.status&&(t.fail=t.fail+1)})}}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},s=(n("+Ppq"),n("KHd+")),c=Object(s.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{direction:"vertical"}},[n("el-row",{attrs:{autogenchild:!1,childcol:24}},[n("span",[t._v("提示：需保证上传的excel文件为单一文件\n        ")])]),t._v(" "),n("div",{staticStyle:{margin:"10px 0px"}},[n("span",[t._v("请先\n        ")]),t._v(" "),n("el-button",{on:{click:t.exportExcel}},[n("span",[t._v("下载模板和教程\n            ")])]),t._v(" "),n("span",[t._v("仔细阅读后，按要求填写车辆信息，并上传摄像机信息表格\n        ")])],1),t._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",{staticStyle:{display:"flex",height:"36px","line-height":"35px"}},[n("span",[t._v("上传的文件：\n            ")]),t._v(" "),n("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"文件路径"}}),t._v(" "),n("el-input",{ref:"upload",attrs:{type:"file",id:"upload"},on:{change:function(e){t.importfxx(this)}}}),t._v(" "),n("el-button",{on:{click:t.uploadOk}},[n("span",[t._v("确认上传\n                ")])])],1),t._v(" "),n("div",[n("span",[t._v("上传共\n            ")]),t._v(" "),n("span",[t._v(t._s(t.num)+"\n            ")]),t._v(" "),n("span",[t._v("条  成功\n            ")]),t._v(" "),n("span",{staticStyle:{color:"green"}},[t._v(t._s(t.success)+"\n            ")]),t._v(" "),n("span",{staticStyle:{color:"green"}},[t._v("条\n            ")]),t._v(" "),n("span",[t._v("失败\n            ")]),t._v(" "),n("span",{staticStyle:{color:"red"}},[t._v(t._s(t.fail)+"\n            ")]),t._v(" "),n("span",{staticStyle:{color:"red"}},[t._v("条\n            ")]),t._v(" "),n("span",[t._v("重复\n            ")]),t._v(" "),n("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.repeat)+"\n            ")]),t._v(" "),n("span",{staticStyle:{color:"blue"}},[t._v("条\n            ")])])]),t._v(" "),n("el-table",{attrs:{data:t.importData,"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px","text-align":"center"}}},[n("el-table-column",{attrs:{label:"设备名称",prop:"title"}}),t._v(" "),n("el-table-column",{attrs:{label:"摄像机位置",prop:"region_title"}}),t._v(" "),n("el-table-column",{attrs:{label:"视频地址",prop:"videoa"}}),t._v(" "),n("el-table-column",{attrs:{label:"分辨率",prop:"resolution"}}),t._v(" "),n("el-table-column",{attrs:{label:"帧率",prop:"framerate"}}),t._v(" "),n("el-table-column",{attrs:{label:"厂商",prop:"corp"}}),t._v(" "),n("el-table-column",{attrs:{label:"状态",prop:"state"}})],1)],1)},[],!1,null,"11394e53",null);c.options.__file="index.vue";e.default=c.exports},rI3T:function(t,e,n){}}]);