(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-171e"],{"/KNT":function(e,t,r){"use strict";r.r(t);var i=r("gDS+"),a=r.n(i),o=r("P2sY"),l=r.n(o),s=r("YEIV"),n=r.n(s),u={name:"",mixins:[r("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){var e;return e={roleData:[],roleTotalRec:0,roleTotalPage:0,roleRecOfPage:10,roleCurPage:1,roleCbPage:this.gen_list_cb("role"),roleQueryArr:[{name:"user_id",val:this.$route.params.id,tb:"user_role"}],roleQueryInit:[{name:"user_id",val:this.$route.params.id,tb:"user_role"}],roleMultiSel:[],roleSortParas:[{name:"title",tb:"role",orderV:"asc"}]},n()(e,"roleRecOfPage",8),n()(e,"isInDialog",!1),n()(e,"pObj",{}),n()(e,"tableHeight",window.innerHeight-420),e},mounted:function(){this.pObj=l()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.roleQueryInit[0].val=this.paramsObj.id,this.roleQueryArr[0].val=this.paramsObj.id):(this.roleQueryInit[0].val=this.$route.params.id,this.roleQueryArr[0].val=this.$route.params.id),this.refreshPage("role","/actq","userrolelist"),this.getTableData(8,1)},methods:{roleMultiSelChange:function(e){this.roleMultiSel=e},roleQuery:function(){this.getTableData(this.remoteRecOfPage,1)},roleResetQuery:function(){this.roleQueryArr=JSON.parse(a()(this.roleQueryInit))},roleSizeChange:function(e){this.getTableData(e,this.roleCurPage)},roleCurChange:function(e){this.getTableData(this.roleRecOfPage,e)},pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.roleQueryInit[0].val=this.paramsObj.id,this.roleQueryArr[0].val=this.paramsObj.id)},getTableData:function(e,t){var r=this,i={_hy:"userrolelist",qps:this.roleQueryArr,sps:this.roleSortParas,rop:e,cp:t};this.callSrvAct("/actq",i).then(function(e){e.data&&"SUCCESS"==e.status&&(r.roleData=e.data.pageData||[],console.log("roleData:",r.roleData),r.$nextTick(function(){for(var e=0;e<r.roleData.length;e++)console.log("lldld:",e,!!r.roleData[e].join_id),r.roleData[e].join_id&&r.$refs.role.toggleRowSelection(r.roleData[e])}))})},tableSelChange:function(e){this.roleMultiSel=e,console.log("this.roleMultiSel:",this.roleMultiSel)},handleClose:function(){this.isInDialog?this.$emit("submitClose"):this.$router.go(-1)},handleSubmit:function(){var e=this;if(this.roleMultiSel&&!(this.roleMultiSel.length<1)){for(var t=[],r=0;r<this.roleMultiSel.length;r++)t.push({role_id:this.roleMultiSel[r].id,user_id:this.paramsObj.id});if(t.length>0){var i={_hy:"userolejoin",user_role:t};this.callSrvAct("/act",i).then(function(t){e.$message({showClose:!0,message:"给用户添加角色成功.",type:"success"})})}}},resetUserRole:function(){var e=this;if(this.roleMultiSel&&!(this.roleMultiSel.length<1)){for(var t=[],r=0;r<this.roleMultiSel.length;r++)t.push(this.roleMultiSel[r].id);if(t.length>0){var i={_hy:"userrolesub",qps:[{name:"user_id",val:this.paramsObj.id,op:"=",tb:"user_role"},{name:"role_id",val:t,op:"in",tb:"user_role"}]};this.callSrvAct("/act",i).then(function(t){e.$message({showClose:!0,message:"从用户移除角色成功.",type:"success"})})}}},submitOrgFormImpl:function(e){var t=this,r=void 0,i=!0,a="";this[e].id>0?(r="/act",i=!1,a="deptup"):(r="/act",a="deptadd");var o=l()({},this[e]);o._hy=a,this.callSrvAct(r,o).then(function(e){console.log("res:",e,t.isInDialog),t.isInDialog?i?e.data&&e.data.inst?t.$emit("submitOk",e.data.inst):e.data&&t.$emit("submitOk",e.data||{}):t.$emit("submitOk",o):t.$router.go(-1)})},submitOrgForm:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return!1;t.submitOrgFormImpl(e)})}},watch:{paramsObj:function(e){this.pObj.id!=this.paramsObj.id&&(this.pObj=l()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},c=(r("GG7f"),r("KHd+")),h=Object(c.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{attrs:{direction:"vertical"}},[r("el-table",{ref:"role",attrs:{stripe:!0,border:!0,"current-row-key":"id",data:e.roleData},on:{"selection-change":e.tableSelChange}},[r("el-table-column",{attrs:{label:"全选",type:"selection"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色名称",prop:"title"}})],1),e._v(" "),r("el-pagination",{staticStyle:{"margin-top":"6px"},attrs:{"page-size":e.roleRecOfPage,total:e.roleTotalRec,"page-count":e.roleTotalPage,layout:"total, sizes, prev, pager, next","page-sizes":[8,20,30,40,50,100]},on:{"size-change":e.roleSizeChange,"current-change":e.roleCurChange}}),e._v(" "),r("el-row",{staticStyle:{"padding-top":"6px"},attrs:{type:"flex",justify:"end"}},[r("el-button",{on:{click:e.handleClose}},[r("span",[e._v("返回\n            ")])]),e._v(" "),r("el-button",{on:{click:e.resetUserRole}},[r("span",[e._v("重置\n            ")])]),e._v(" "),r("el-button",{on:{click:e.handleSubmit}},[r("span",[e._v("提交\n            ")])])],1)],1)},[],!1,null,"701000b2",null);h.options.__file="index.vue";t.default=h.exports},GG7f:function(e,t,r){"use strict";var i=r("X/im");r.n(i).a},"RU/L":function(e,t,r){r("Rqdy");var i=r("WEpk").Object;e.exports=function(e,t,r){return i.defineProperty(e,t,r)}},Rqdy:function(e,t,r){var i=r("Y7ZC");i(i.S+i.F*!r("jmDH"),"Object",{defineProperty:r("2faE").f})},SEkw:function(e,t,r){e.exports={default:r("RU/L"),__esModule:!0}},"X/im":function(e,t,r){},YEIV:function(e,t,r){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(r("SEkw"));t.default=function(e,t,r){return t in e?(0,i.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}}}]);